# hw5

* монолит
* реактивщина
* без ОРМ
* добавлены индексы к полям для поиска
* добавлено кеширование ленты друзей
* добавлены вебсокеты и реббит



план

логинимся и подписываемся на обновления постов от друзей - делаем биндинг на все очереди с роутингом = uuid публикующего
при разлогине - удаляем биндинги? - сами удалятся поскольку экслюзив
при публикации нового поста 
 - сохраняем в БД
 - инвалидируем старый кеш у всех подписантов
 - публикуем в экчендж c роутинг ключем = id публикующего пользователя
 - подписчики создают временные очереди c биндингом = id публикующего пользователя
 - поскольку очереди экслюзивные можно создавать сколько угодно инстансов, заберет подписку только один
 - имена очередей должны быть уникальными для разных подписчиков но не разные для разных инстансов одного подписчика- subscription-<interest_id>-<subscriber_id>
 - создаемвебсокет который публикует подписчику новый пост в subscriber_id


### install

mvn clean install
docker build -f docker/Dockerfile.jvm -t otus-highload-hw5:latest .
docker images

### publish

docker tag otus-highload-hw5:latest recvezitor/otus-highload-hw5:latest
docker login -> recvezitor/password
docker push recvezitor/otus-highload-hw5:latest

### deploy 

docker compose -f ./docker/docker-compose.yml up

### Инструкция

1. Залогиниться под Леопольдом
2. Получить посты друзей Леопольда первый раз - пойдем в БД и сохраним в кеш
3. Получить посты друзей Леопольда второй раз - берем из кеша
4. Логинимся под Леди Гагой
5. Публикуем пост под Леди Гагой - у Леопольда будет инвалидация кеша
